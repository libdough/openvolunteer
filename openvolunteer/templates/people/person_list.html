{% extends "base.html" %}

{% block title %}
  People
{% endblock title %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="mb-0">People</h1>
      <small class="text-muted">{{ people|length }} total</small>
    </div>
    {% if can_edit %}
      <a href="{% url 'people:person_create' %}" class="btn btn-primary">➕ Add person</a>
    {% endif %}
  </div>
  <div class="card shadow-sm">
    <div class="table-responsive">
      {% include "components/filters.html" %}
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light sticky-top">
          <tr>
            <th>Name</th>
            <th>Contact</th>
            <th>Organizations</th>
            <th>Tags</th>
          </tr>
        </thead>
        <tbody>
          {% for person in people %}
            <tr style="cursor:pointer"
                onclick="window.location='{% url 'people:person_detail' person_id=person.id %}'">
              <td>
                <strong>{{ person.full_name }}</strong>
                {% if person.discord %}<div class="text-muted small">{{ person.discord }}</div>{% endif %}
              </td>
              <td class="small">
                {% if person.discord %}<div>{{ person.discord }}</div>{% endif %}
                {% if person.email %}<div>{{ person.email }}</div>{% endif %}
                {% if person.phone %}<div>{{ person.phone }}</div>{% endif %}
                {% if not person.discord and not person.email and not person.phone %}<span class="text-muted">—</span>{% endif %}
              </td>
              <td class="small">
                {% for link in person.org_links.all %}
                  <span class="badge bg-secondary me-1">{{ link.org.name }}</span>
                {% empty %}
                  <span class="text-muted">—</span>
                {% endfor %}
              </td>
              <td>
                {% for tagging in person.taggings.all %}
                  <span class="tag-pill" style="--tag-color: {{ tagging.tag.color_hex }};">{{ tagging.tag.name }}</span>
                {% empty %}
                  <span class="text-muted">—</span>
                {% endfor %}
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="4" class="text-center py-5 text-muted">No people found.</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
      {% include "components/pagination.html" %}
    </div>
  </div>
{% endblock content %}
